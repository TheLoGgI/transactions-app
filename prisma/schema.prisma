// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "sqlite"
    url      = env("DATABASE_URL")
}

model Transaction {
    id              String        @id @default(uuid())
    transactionKey  String        @unique
    merchantId      String?
    merchant        Merchant?     @relation(fields: [merchantId], references: [id])
    Sender          Sender?       @relation(fields: [senderId], references: [id])
    senderId        String?
    agent           AgentType
    transactionType String
    amount          Float
    currencyCode    String
    subcategoryId   Int?
    subcategory     SubCategories? @relation(fields: [subcategoryId], references: [id])
    createdAt       DateTime      @default(now())
    updatedAt       DateTime      @updatedAt

    @@map("transaction")
}

model Categories {
    id            Int             @id @default(autoincrement())
    name          String          @unique
    description   String?
    prefix        Int
    color         String
    createdAt     DateTime        @default(now())
    updatedAt     DateTime        @updatedAt
    SubCategories SubCategories[]

    @@index([name])
    @@map("subcategories")
}

model SubCategories {
    id           Int           @id @default(autoincrement())
    name         String
    code         String
    description  String?
    createdAt    DateTime      @default(now())
    updatedAt    DateTime      @updatedAt
    categoryId   Int
    category     Categories   @relation(fields: [categoryId], references: [id])
    transactions Transaction[]

    @@index([name])
    @@map("categories")
}

model Merchant {
    id           String        @id @default(uuid())
    name         String
    categoryCode String
    merchantId   String
    city         String
    country      String
    createdAt    DateTime      @default(now())
    updatedAt    DateTime      @updatedAt
    transactions Transaction[]

    @@index([name])
    @@map("merchant")
}

model Sender {
    id           String        @id @default(uuid())
    name         String
    city         String
    country      String?
    key          String        @unique
    createdAt    DateTime      @default(now())
    updatedAt    DateTime      @updatedAt
    transactions Transaction[]

    @@index([name])
    @@map("sender")
}

enum AgentType {
    SENDER
    RECEIVER
    UNKNOWN
}
